{"ast":null,"code":"let axios = require(\"axios\").default;\n\nlet getTokenOptions = {\n  method: 'POST',\n  url: 'https://leonfyp.eu.auth0.com/oauth/token',\n  headers: {\n    'content-type': 'application/json'\n  },\n  data: {\n    grant_type: 'client_credentials',\n    client_id: process.env.AUTH0_CLIENT_ID,\n    client_secret: process.env.AUTH0_CLIENT_SECRET,\n    audience: 'https://leonfyp.eu.auth0.com/api/v2/'\n  }\n};\nexport default async function updateUser(req, res) {\n  if (req.method !== 'POST') {\n    res.status(400).send({\n      message: 'Only POST requests allowed'\n    });\n    return;\n  }\n\n  axios.request(getTokenOptions).then(function (response) {\n    axios.request({\n      method: 'PATCH',\n      url: 'https://leonfyp.eu.auth0.com/api/v2/users/' + req.body.id,\n      headers: {\n        'content-type': \"application/json\",\n        'Authorization': 'Bearer ' + response.data.access_token\n      },\n      data: {\n        user_metadata: {\n          commerceID: req.body.commerceID\n        }\n      }\n    }).then(function (response) {\n      console.log(response.data);\n      res.send(response.data);\n    }).catch(function (error) {\n      console.error(error);\n      res.status(error.status || 500).end(error.message);\n    });\n  }).catch(function (error) {\n    console.error(error);\n    res.status(error.status || 500).end(error.message);\n  });\n}","map":{"version":3,"sources":["C:/Users/KGM/OneDrive/Documents/GitHub/chec/fyp/pages/api/auth/updateuser.js"],"names":["axios","require","default","getTokenOptions","method","url","headers","data","grant_type","client_id","process","env","AUTH0_CLIENT_ID","client_secret","AUTH0_CLIENT_SECRET","audience","updateUser","req","res","status","send","message","request","then","response","body","id","access_token","user_metadata","commerceID","console","log","catch","error","end"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAAP,CAAiBC,OAA7B;;AAEA,IAAIC,eAAe,GAAG;AACpBC,EAAAA,MAAM,EAAE,MADY;AAEpBC,EAAAA,GAAG,EAAE,0CAFe;AAGpBC,EAAAA,OAAO,EAAE;AAAE,oBAAgB;AAAlB,GAHW;AAIpBC,EAAAA,IAAI,EAAE;AACJC,IAAAA,UAAU,EAAE,oBADR;AAEJC,IAAAA,SAAS,EAAEC,OAAO,CAACC,GAAR,CAAYC,eAFnB;AAGJC,IAAAA,aAAa,EAAEH,OAAO,CAACC,GAAR,CAAYG,mBAHvB;AAIJC,IAAAA,QAAQ,EAAE;AAJN;AAJc,CAAtB;AAcA,eAAe,eAAeC,UAAf,CAA0BC,GAA1B,EAA+BC,GAA/B,EAAoC;AACjD,MAAID,GAAG,CAACb,MAAJ,KAAe,MAAnB,EAA2B;AACzBc,IAAAA,GAAG,CAACC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB;AACA;AACD;;AACDrB,EAAAA,KAAK,CAACsB,OAAN,CAAcnB,eAAd,EAA+BoB,IAA/B,CAAoC,UAAUC,QAAV,EAAoB;AAEtDxB,IAAAA,KAAK,CAACsB,OAAN,CAAc;AACZlB,MAAAA,MAAM,EAAE,OADI;AAEZC,MAAAA,GAAG,EAAE,+CAA+CY,GAAG,CAACQ,IAAJ,CAASC,EAFjD;AAIZpB,MAAAA,OAAO,EAAE;AACP,wBAAgB,kBADT;AAEP,yBAAiB,YAAYkB,QAAQ,CAACjB,IAAT,CAAcoB;AAFpC,OAJG;AAQZpB,MAAAA,IAAI,EAAE;AAAEqB,QAAAA,aAAa,EAAE;AAAEC,UAAAA,UAAU,EAAEZ,GAAG,CAACQ,IAAJ,CAASI;AAAvB;AAAjB;AARM,KAAd,EASGN,IATH,CASQ,UAAUC,QAAV,EAAoB;AAC1BM,MAAAA,OAAO,CAACC,GAAR,CAAYP,QAAQ,CAACjB,IAArB;AACAW,MAAAA,GAAG,CAACE,IAAJ,CAASI,QAAQ,CAACjB,IAAlB;AACD,KAZD,EAYGyB,KAZH,CAYS,UAAUC,KAAV,EAAiB;AACxBH,MAAAA,OAAO,CAACG,KAAR,CAAcA,KAAd;AACAf,MAAAA,GAAG,CAACC,MAAJ,CAAWc,KAAK,CAACd,MAAN,IAAgB,GAA3B,EAAgCe,GAAhC,CAAoCD,KAAK,CAACZ,OAA1C;AACD,KAfD;AAgBD,GAlBD,EAkBGW,KAlBH,CAkBS,UAAUC,KAAV,EAAiB;AACxBH,IAAAA,OAAO,CAACG,KAAR,CAAcA,KAAd;AACAf,IAAAA,GAAG,CAACC,MAAJ,CAAWc,KAAK,CAACd,MAAN,IAAgB,GAA3B,EAAgCe,GAAhC,CAAoCD,KAAK,CAACZ,OAA1C;AACD,GArBD;AAuBD","sourcesContent":["let axios = require(\"axios\").default;\r\n\r\nlet getTokenOptions = {\r\n  method: 'POST',\r\n  url: 'https://leonfyp.eu.auth0.com/oauth/token',\r\n  headers: { 'content-type': 'application/json' },\r\n  data: {\r\n    grant_type: 'client_credentials',\r\n    client_id: process.env.AUTH0_CLIENT_ID,\r\n    client_secret: process.env.AUTH0_CLIENT_SECRET,\r\n    audience: 'https://leonfyp.eu.auth0.com/api/v2/'\r\n  }\r\n};\r\n\r\n\r\n\r\nexport default async function updateUser(req, res) {\r\n  if (req.method !== 'POST') {\r\n    res.status(400).send({ message: 'Only POST requests allowed' })\r\n    return\r\n  }\r\n  axios.request(getTokenOptions).then(function (response) {\r\n\r\n    axios.request({\r\n      method: 'PATCH',\r\n      url: 'https://leonfyp.eu.auth0.com/api/v2/users/' + req.body.id\r\n      ,\r\n      headers: {\r\n        'content-type': \"application/json\",\r\n        'Authorization': 'Bearer ' + response.data.access_token\r\n      },\r\n      data: { user_metadata: { commerceID: req.body.commerceID } }\r\n    }).then(function (response) {\r\n      console.log(response.data);\r\n      res.send(response.data);\r\n    }).catch(function (error) {\r\n      console.error(error);\r\n      res.status(error.status || 500).end(error.message);\r\n    });\r\n  }).catch(function (error) {\r\n    console.error(error);\r\n    res.status(error.status || 500).end(error.message);\r\n  });\r\n\r\n}"]},"metadata":{},"sourceType":"module"}